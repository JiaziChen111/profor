
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Profor Combination Details</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-06-25"><meta name="DC.source" content="combination_overview.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Profor Combination Details</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Batchcombination</a></li><li><a href="#2">An example</a></li><li><a href="#5">What's going on in Profor.doModels for this example?</a></li><li><a href="#8">What's going on in Profor.doCombinations?</a></li><li><a href="#13">Constructing forecast combinations</a></li><li><a href="#14">Example real-time results matrix</a></li></ul></div><h2>Batchcombination<a name="1"></a></h2><p>The sample property in the Batchcombination file required defines the period over which models will be evaluated / combined. Note that the dates refer to data vintages in the out of sample evaluation period. If there is a one-period lag in the release of the macro data, then the first forecast origin is one period prior to the start date in the Batchcombination sample command.</p><h2>An example<a name="2"></a></h2><p>Consider an example case where we have 5 periods, P1 - P5. These 5 periods will correspond to 5 potentially different vintages of data, V1 - V5. In the figure below illustrates the typical quarterly macro data structure for which there is a one period data release lag (ticks where data are available, and crosses for no data availability).</p><p><img vspace="5" hspace="5" src="img/typical-data-structure.png" alt=""> </p><p><b>Essential experiment settings</b></p><p>Suppose the researcher specifies:</p><p>1. Batchcombination.sample = 'P1-P5'</p><p>2. Batchcombination.forecastSettings.nfor = 4</p><p>That is, evaluates (combineS) over the (out of sample) evaluation sample 'P1-P5' and for a forecast horizon 1 through 4.</p><h2>What's going on in Profor.doModels for this example?<a name="5"></a></h2><p>PROFOR recursively passes through the evaluation sample and estimates 5 models, 'M1-M5', using data sources that can be model specific, provided by the corrspending data sources in vintages 'V1-V5'. These models are stored in seperate folders.</p><p>The figure below shows each of these models and the forecasts produced. Note, that because we have a 1 period data lag requesting nfor = 4 will produce 5 forecasts including the nowcast (h=0).</p><p><img vspace="5" hspace="5" src="img/model-forecast-horizons.png" alt=""> </p><p>These model vintages will be used in the following combination stage.</p><h2>What's going on in Profor.doCombinations?<a name="8"></a></h2><p>The diagram below shows the 4 evaluation periods at each date specified in the sample command in green, from h=1 to h=4.</p><p><img vspace="5" hspace="5" src="img/combo-sample-evaln-periods.png" alt=""> </p><p><b>Timing Nuance</b></p><p>Although we specify to combine with 'forecastSettings.nfor = 4', Profor starts the 1-step evaluation from the current period (nowcast), i.e. for P1, the first (h=0) forecast is  the nowcast.</p><p>Suppose these models have the same structure, so in the estimation step all that happens is the extraction of the models from the Profor.doModels step, plus the evaluation and combination of forecasts. Below you see salient features of a combination and one element of the resultCell where all of the evaluation results are stored for each vintage.</p><p><img vspace="5" hspace="5" src="img/model_combination.png" alt=""> </p><p><b>Timing Nuances / Recursive Structure</b></p><p>Profor.doCombination passes recursively over the evaluation sample (P1-P5) evaluating 5 forecasts for each data vintage, V1-V5.</p><p><b>Results</b></p><p>The results of the combination stage are stored as models in a folder in the results directory as combination_&lt;variable_name&gt;/results/&lt;vintage&gt;, e.g. 'combination_gdp/results/2000.02'.</p><p>The extraction and storing of these forecasts and evaluations are located in the model.estimation.resultCell.</p><p>This experiment will store 5 sub-folders corresponding to the evaluation of the 5 seperate models (M1-M5).</p><h2>Constructing forecast combinations<a name="13"></a></h2><p>The latest weights available at each horizon are used to construct the corresponding forecasts and stored as Tsdataforecast objects in the forecasting property of model.</p><h2>Example real-time results matrix<a name="14"></a></h2><p>The illustration below displays the log scores for 2 forecasts horizons across different vintages. NAN's occur where the observation being forecast isn't available (yet).</p><p><img vspace="5" hspace="5" src="img/real-time-h1.png" alt=""> </p><p><img vspace="5" hspace="5" src="img/real-time-h2.png" alt=""> </p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Profor Combination Details
% 
%% Batchcombination
% The sample property in the Batchcombination file required defines 
% the period over which models will be evaluated / combined. Note that
% the dates refer to data vintages in the out of sample evaluation period.
% If there is a one-period lag in the release of the macro data, then the 
% first forecast origin is one period prior to the start date in the 
% Batchcombination sample command.
% 
%% An example
% Consider an example case where we have 5 periods, P1 - P5. 
% These 5 periods will correspond to 5 potentially different vintages of data, 
% V1 - V5. 
% In the figure below illustrates the typical quarterly macro data structure for 
% which there is a one period data release lag (ticks where data are
% available, and crosses for no data availability).
% 
%%
% <<img/typical-data-structure.png>>
%%
% *Essential experiment settings*
% 
% Suppose the researcher specifies: 
% 
% 1. Batchcombination.sample = 'P1-P5'
% 
% 2. Batchcombination.forecastSettings.nfor = 4
% 
% That is, evaluates (combineS) over the (out of sample) evaluation sample 
% 'P1-P5' and for a forecast horizon 1 through 4.
% 
%% What's going on in Profor.doModels for this example?
% PROFOR recursively passes through the evaluation sample and estimates 5 models,
% 'M1-M5', using data sources that can be model specific, provided by the corrspending data 
% sources in vintages 'V1-V5'. These models are stored in seperate folders. 
% 
% The figure below shows each of these models and the forecasts produced. 
% Note, that because we have a 1 period data lag requesting nfor = 4 will
% produce 5 forecasts including the nowcast (h=0).
%
%%
% <<img/model-forecast-horizons.png>>
% 
%%
% These model vintages will be used in the following combination stage.
%% What's going on in Profor.doCombinations?
% 
% 
% The diagram below shows the 4 evaluation periods at each date specified in the
% sample command in green, from h=1 to h=4. 
%%
% <<img/combo-sample-evaln-periods.png>>
% 
%%
% *Timing Nuance*
% 
% Although we specify to combine with 'forecastSettings.nfor = 4', Profor starts 
% the 1-step evaluation from the current period (nowcast), i.e. for P1, the 
% first (h=0) forecast is  the nowcast.
% 
% Suppose these models have the same structure, so in the estimation
% step all that happens is the extraction of the models from the Profor.doModels
% step, plus the evaluation and combination of forecasts.
% Below you see salient features of a combination and one element of the
% resultCell where all of the evaluation results are stored for each vintage.
% 
%%
% <<img/model_combination.png>>
% 
%%
% *Timing Nuances / Recursive Structure*
% 
% Profor.doCombination passes recursively over the evaluation sample (P1-P5)
% evaluating 5 forecasts for each data vintage, V1-V5.
%
% *Results*
% 
% The results of the combination stage are stored as models in a folder in the
% results directory as combination_<variable_name>/results/<vintage>, e.g. 
% 'combination_gdp/results/2000.02'. 
% 
% The extraction and storing of these forecasts and evaluations are located in
% the model.estimation.resultCell.
% 
% This experiment will store 5 sub-folders corresponding to the evaluation of
% the 5 seperate models (M1-M5).
% 
%% Constructing forecast combinations
% 
% The latest weights available at each horizon are used to construct the
% corresponding forecasts and stored as Tsdataforecast objects in the forecasting
% property of model. 

%% Example real-time results matrix
% The illustration below displays the log scores for 2 forecasts horizons across
% different vintages.
% NAN's occur where the observation being forecast isn't available (yet).

%%
% <<img/real-time-h1.png>>

%%
% <<img/real-time-h2.png>>

























##### SOURCE END #####
--></body></html>